window.calendar=function(){function e(e){return document.getElementById(e)}function t(e){return document.createElement(e)}function n(e){function t(e,t){return new Date(31556925974.7*(e-1900)+6e4*h[t]+Date.UTC(1900,0,6,2,5)).getUTCDate()}function n(e){var t,n=348;for(t=32768;t>8;t>>=1)n+=i[e-1900]&t?1:0;return n+v(e)}function a(e){return s.charAt(e%10)+r.charAt(e%12)}function v(e){return I(e)?65536&i[e-1900]?30:29:0}function I(e){return 15&i[e-1900]}function p(e,t){return i[e-1900]&65536>>t?30:29}function g(e){var t,a=0,i=0,s=new Date(1900,0,31),r=(e-s)/864e5;for(this.dayCyl=r+40,this.monCyl=14,t=1900;t<2050&&r>0;t++)i=n(t),r-=i,this.monCyl+=12;for(r<0&&(r+=i,t--,this.monCyl-=12),this.year=t,this.yearCyl=t-1864,a=I(t),this.isLeap=!1,t=1;t<13&&r>0;t++)a>0&&t==a+1&&0==this.isLeap?(--t,this.isLeap=!0,i=v(this.year)):i=p(this.year,t),1==this.isLeap&&t==a+1&&(this.isLeap=!1),r-=i,0==this.isLeap&&this.monCyl++;0==r&&a>0&&t==a+1&&(this.isLeap?this.isLeap=!1:(this.isLeap=!0,--t,--this.monCyl)),r<0&&(r+=i,--t,--this.monCyl),this.month=t,this.day=r+1}function M(e){return e<10?"0"+e:e}function w(e,t){var n=e;return t.replace(/dd?d?d?|MM?M?M?|yy?y?y?/g,function(e){switch(e){case"yyyy":var t="000"+n.getFullYear();return t.substring(t.length-4);case"dd":return M(n.getDate());case"d":return n.getDate().toString();case"MM":return M(n.getMonth()+1);case"M":return n.getMonth()+1}})}this.date=e,this.isToday=!1,this.isRestDay=!1,this.solarYear=w(e,"yyyy"),this.solarMonth=w(e,"M"),this.solarDate=w(e,"d"),this.solarWeekDay=e.getDay(),this.solarWeekDayInChinese="星期"+u.charAt(this.solarWeekDay);var D=new g(e);this.lunarYear=D.year,this.shengxiao=l.charAt((this.lunarYear-4)%12),this.lunarMonth=D.month,this.lunarIsLeapMonth=D.isLeap,this.lunarMonthInChinese=this.lunarIsLeapMonth?"闰"+c[D.month-1]:c[D.month-1],this.lunarDate=D.day,this.showInLunar=this.lunarDateInChinese=function(e,t){var n;switch(t){case 10:n="初十";break;case 20:n="二十";break;case 30:n="三十";break;default:n=d.charAt(Math.floor(t/10)),n+=u.charAt(t%10)}return n}(this.lunarMonth,this.lunarDate),1==this.lunarDate&&(this.showInLunar=this.lunarMonthInChinese+"月"),this.ganzhiYear=a(D.yearCyl),this.ganzhiMonth=a(D.monCyl),this.ganzhiDate=a(D.dayCyl++),this.jieqi="",this.restDays=0,t(this.solarYear,2*(this.solarMonth-1))==w(e,"d")&&(this.showInLunar=this.jieqi=o[2*(this.solarMonth-1)]),t(this.solarYear,2*(this.solarMonth-1)+1)==w(e,"d")&&(this.showInLunar=this.jieqi=o[2*(this.solarMonth-1)+1]),"清明"==this.showInLunar&&(this.showInLunar="清明节",this.restDays=1),this.solarFestival=y[w(e,"MM")+w(e,"dd")],void 0===this.solarFestival?this.solarFestival="":/\*(\d)/.test(this.solarFestival)&&(this.restDays=parseInt(RegExp.$1),this.solarFestival=this.solarFestival.replace(/\*\d/,"")),this.showInLunar=""==this.solarFestival?this.showInLunar:this.solarFestival,this.lunarFestival=f[this.lunarIsLeapMonth?"00":M(this.lunarMonth)+M(this.lunarDate)],void 0===this.lunarFestival?this.lunarFestival="":/\*(\d)/.test(this.lunarFestival)&&(this.restDays=this.restDays>parseInt(RegExp.$1)?this.restDays:parseInt(RegExp.$1),this.lunarFestival=this.lunarFestival.replace(/\*\d/,"")),12==this.lunarMonth&&this.lunarDate==p(this.lunarYear,12)&&(this.lunarFestival=f["0100"],this.restDays=1),this.showInLunar=""==this.lunarFestival?this.showInLunar:this.lunarFestival,this.showInLunar=this.showInLunar.length>4?this.showInLunar.substr(0,2)+"...":this.showInLunar}var a=navigator.userAgent.indexOf("MSIE")!=-1&&!window.opera,i=[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448],s="甲乙丙丁戊己庚辛壬癸",r="子丑寅卯辰巳午未申酉戌亥",l="鼠牛虎兔龙蛇马羊猴鸡狗猪",o=["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],h=[0,21208,43467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758],u="日一二三四五六七八九十",c=["正","二","三","四","五","六","七","八","九","十","十一","腊"],d="初十廿卅",y={"0101":"*1元旦节","0214":"情人节","0305":"学雷锋纪念日","0308":"妇女节","0312":"植树节","0315":"消费者权益日","0401":"愚人节","0501":"*1劳动节","0504":"青年节","0601":"国际儿童节","0701":"中国共产党诞辰","0801":"建军节","0910":"中国教师节",1001:"*3国庆节",1224:"平安夜",1225:"圣诞节"},f={"0101":"*2春节","0115":"元宵节","0505":"*1端午节","0815":"*1中秋节","0909":"重阳节",1208:"腊八节","0100":"除夕"},v=null,I=function(){function e(e){return e%4==0&&e%100!=0||e%400==0}function t(t,n){return[31,e(t)?29:28,31,30,31,30,31,31,30,31,30,31][n]}function a(e,t){return e.setDate(e.getDate()+t),e}function i(e){var i=0,r=new n(new Date(e.solarYear,e.solarMonth-1,1)),l=r.solarWeekDay-1==-1?6:r.solarWeekDay-1;s.lines=Math.ceil((l+t(e.solarYear,e.solarMonth-1))/7);for(var o=0;o<s.dateArray.length;o++)if(0!=r.restDays&&(i=r.restDays),i>0&&(r.isRest=!0),l-- >0||r.solarMonth!=e.solarMonth)s.dateArray[o]=null;else{var h=new n(new Date);r.solarYear==h.solarYear&&r.solarMonth==h.solarMonth&&r.solarDate==h.solarDate&&(r.isToday=!0),s.dateArray[o]=r,r=new n(a(r.date,1)),i--}}var s={};return s.lines=0,s.dateArray=new Array(42),{init:function(e){i(e)},getJson:function(){return s}}}(),p=function(){function e(){d=d||document.getElementById(v.yearSelectId),y=y||document.getElementById(v.monthSelectId),f=f||document.getElementById(v.heavenlyId),p=p||document.getElementById(v.branchId),M=M||document.getElementById(v.prevId),w=w||document.getElementById(v.nextId),D=D||document.getElementById(v.nowDateId),v.isSelect||(d.style.display="none",y.style.display="none"),v.isHeavenlyBranch||(f.style.display="none",p.style.display="none")}function a(e){f.innerHTML=e.ganzhiYear,p.innerHTML=e.shengxiao}function i(e){d[e.solarYear-1901].selected=!0,y[e.solarMonth-1].selected=!0}function s(e){var t=d.value,a=y.value,i=new n(new Date(t,a-1,1));I.init(i),g.draw(),(this==d||e)&&(i=new n(new Date(t,3,1)),f.innerHTML=i.ganzhiYear,p.innerHTML=i.shengxiao);var s=new n(new Date);D.style.visibility=t==s.solarYear&&a==s.solarMonth?"hidden":"visible"}function r(){return{j:d.value,g:y.value}}function l(){var e=r(),t=!1,n=--e.g;0===n?(d.value=--e.j,y.value=12,t=!0):(d.value=e.j,y.value=n),s(t)}function o(){var e=r(),t=!1,n=++e.g;13===n?(d.value=++e.j,y.value=1,t=!0):(d.value=e.j,y.value=n),s(t)}function h(){var e=new n(new Date);a(e),i(e),I.init(e),g.draw(),D.style.visibility="hidden"}function u(e,n){for(var a=1901;a<2050;a++){var i=t("OPTION");i.value=a,i.innerHTML=a,a==e&&(i.selected="selected"),d.appendChild(i)}for(var a=1;a<13;a++){var i=t("OPTION");i.value=a,i.innerHTML=a,a==n&&(i.selected="selected"),y.appendChild(i)}d.onchange=s,y.onchange=s,M.onclick=l,w.onclick=o}function c(e){u(e.solarYear,e.solarMonth),f.innerHTML=e.ganzhiYear,p.innerHTML=e.shengxiao,D.onclick=h,D.style.visibility="hidden"}var d,y,f,p,M,w,D;return{init:function(t){e(),c(t)},reset:function(t){e(),i(t)}}}(),g=function(){function n(){var n=I.getJson(),a=n.dateArray;e("cm").style.height=40*n.lines+2+"px",e("cm").innerHTML="";for(var i=0;i<a.length;i++)if(null!=a[i]){var s=t("DIV");a[i].isToday&&(s.style.cssText="background:#cde9d9;border-radius:50%;padding:5px 0;"),s.className="cell",s.style.left=i%7*60+"px",s.style.top=40*Math.floor(i/7)+2+"px";var r=t("DIV");r.className="so",r.style.color=i%7>4||a[i].isRest?"#429e6c":"#666",r.innerHTML=a[i].solarDate,s.appendChild(r);var l=t("DIV");l.style.color="#888",l.innerHTML=a[i].showInLunar,s.appendChild(l),s.onmouseover=function(e){return function(t){M.show({dateIndex:e,cell:this})}}(i),s.onmouseout=function(){M.hide()},s.onclick=function(e,t){return function(n){M.click({dateIndex:e,cellClickCallback:t,cell:this})}}(i,v.cellClickCallback),e("cm").appendChild(s)}var o=t("DIV");o.id="fd",v.isShowFd&&e("cm").appendChild(o),M.init(o)}return{draw:function(){n()}}}(),M=function(){function e(e,t){if(arguments.length>1){var n=/([.*+?^=!:${}()|[\]\/\\])/g,a="{".replace(n,"\\$1"),i="}".replace(n,"\\$1"),s=new RegExp("#"+a+"([^"+a+i+"]+)"+i,"g");if("object"==typeof t)return e.replace(s,function(e,n){var a=t[n];return void 0===a?"":a})}return e}function t(t){var n=I.getJson().dateArray[t.dateIndex],a=t.cell,s="#{solarYear} 年 #{solarMonth} 月 #{solarDate} 日 #{solarWeekDayInChinese}";s+="<br><b>农历 #{lunarMonthInChinese}月#{lunarDateInChinese}</b>",s+="<br>#{ganzhiYear}年 #{ganzhiMonth}月 #{ganzhiDate}日",""==n.solarFestival&&""==n.lunarFestival&&""==n.jieqi||(s+="<br><b>#{lunarFestival} #{solarFestival} #{jieqi}</b>"),i.innerHTML=e(s,n),i.style.top=a.offsetTop+a.offsetHeight-45+"px",i.style.left=a.offsetLeft+a.offsetWidth+10+"px",i.style.display="block"}function n(e){var t=e.cellClickCallback,n=I.getJson().dateArray[e.dateIndex];"function"==typeof t&&t(e.cell,n)}function a(){i.style.display="none"}var i;return{click:function(e){n(e)},show:function(e){t(e)},hide:function(){a()},init:function(e){i=e}}}(),w={cellClickCallback:function(e,t){},yearSelectId:"year-select",monthSelectId:"month-select",heavenlyId:"heavenly",branchId:"branch",prevId:"prev",nextId:"next",nowDateId:"now-date",isSelect:!0,isHeavenlyBranch:!0,isShowFd:!0};return{init:function(e){v=Object.assign({},w,e);var t=new n(new Date);a&&window.attachEvent("onload",function(){p.reset(t)}),p.init(t),I.init(t),g.draw()}}}();